<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skilled-Jobs English: Reading & Writing Tests</title>
  <style>
    :root {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      color: #0f172a;
    }
    body {
      max-width: 900px;
      margin: 28px auto;
      padding: 20px;
      background: #fff;
    }
    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }
    h1 {
      font-size: 1.25rem;
      margin: 0;
    }
    .name-field {
      font-size: 0.95rem;
      border: 1px solid #cbd5e1;
      border-radius: 6px;
      padding: 6px;
      width: 260px;
    }
    .level {
      border: 1px solid #dbe7f7;
      border-radius: 8px;
      padding: 14px;
      margin: 18px 0;
      background: #ffffff;
    }
    h2 {
      font-size: 1.05rem;
      margin: 6px 0;
    }
    .passage {
      background: #fafafa;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #eef2f7;
      margin-bottom: 10px;
      font-size: 0.95rem;
    }
    .question {
      margin: 8px 0;
      padding: 8px;
      border-left: 3px solid #e6eef8;
      border-radius: 4px;
    }
    label {
      display: block;
      cursor: pointer;
      margin: 3px 0;
    }
    .short-answer {
      width: 100%;
      min-height: 44px;
      padding: 8px;
      border: 1px solid #e6eef8;
      border-radius: 6px;
      font-size: 0.95rem;
    }
    .controls {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-top: 12px;
    }
    button {
      background: #0f172a;
      color: #fff;
      border: none;
      padding: 8px 12px;
      border-radius: 6px;
      cursor: pointer;
    }
    .result {
      margin-top: 12px;
      padding: 10px;
      border-radius: 6px;
      background: #f8fafc;
      border: 1px solid #e6eef8;
      font-size: 0.95rem;
    }
    textarea {
      width: 100%;
      min-height: 140px;
      padding: 8px;
      border: 1px solid #e6eef8;
      border-radius: 6px;
      font-size: 0.95rem;
    }
    .hint {
      font-size: 0.9rem;
      color: #0f172a;
      background: #fbfbfb;
      padding: 10px;
      border-radius: 6px;
      border: 1px solid #eef2f7;
    }
    footer {
      margin-top: 22px;
      font-size: 0.9rem;
      color: #334155;
    }
    @media (max-width:700px){
      header{flex-direction:column;align-items:flex-start}
      .name-field{width:100%}
    }
  </style>
</head>
<body>

<header>
  <h1>Skilled-Jobs English — Reading & Writing</h1>
  <div>
    <label for="candidateName"><strong>Candidate Name:</strong></label><br>
    <input id="candidateName" class="name-field" type="text" placeholder="Write your full name here">
  </div>
</header>

<p class="hint">
  <strong>Instructions:</strong> Open this file on Chrome. Complete all sections.
  After finishing, follow Final Instructions at the bottom to save your test and send it to the assessor.
</p>
<section class="level" id="A1T1">
  <h2>A1 Test 1 – Reading</h2>
  <div class="passage">Mark takes bus number 6 to go to work every morning. He usually sits near the window and reads the newspaper. The bus stop is close to his house.</div>
  <div class="question">
    <p>1. What bus number does Mark take?</p>
    <label><input type="radio" name="a1t1_q1" value="6"> 6</label>
    <label><input type="radio" name="a1t1_q1" value="10"> 10</label>
    <label><input type="radio" name="a1t1_q1" value="5"> 5</label>
  </div>
  <div class="question">
    <p>2. Where does Mark read the newspaper?</p>
    <label><input type="radio" name="a1t1_q2" value="home"> At home</label>
    <label><input type="radio" name="a1t1_q2" value="mark"> On the bus</label>
  </div>
  <div class="question">
    <p>3. What kind of transport does he use?</p>
    <input id="a1t1_q3" class="short-answer" placeholder="Type your answer">
  </div>
  <div class="controls"><button id="btnA1T1">Submit</button></div>
  <div id="resultA1T1" class="result"></div>
</section>
<section class="level" id="A1T2">
  <h2>A1 Test 2 – Reading</h2>
  <div class="passage">
    Joe is a plumber. He starts work at 8:00 and finishes at half past 12. He enjoys fixing pipes and helping people with water problems.
  </div>
  <div class="question">
    <p>1. What is Joe’s job?</p>
    <label><input type="radio" name="a1t2_q1" value="plumber"> Plumber</label>
    <label><input type="radio" name="a1t2_q1" value="driver"> Driver</label>
  </div>
  <div class="question">
    <p>2. What time does he finish work?</p>
    <input id="a1t2_q2" class="short-answer" placeholder="Type your answer">
  </div>
  <div class="controls"><button id="btnA1T2">Submit</button></div>
  <div id="resultA1T2" class="result"></div>
</section>
  <!-- ======== A2T1 ======== -->
<section class="level" id="A2T1">
  <h2>A2 Test 1 – Reading</h2>
  <div class="passage">
    During the summer, our group goes on vacation every weekend at the beach. I lead a group of sales rep, and plan the team-building activity for collaboration and motivation.
  </div>
  <div class="question">
    <p>1. Where does the group go on weekends?</p>
    <label><input type="radio" name="a2t1_q1" value="mountain"> The mountain</label>
    <label><input type="radio" name="a2t1_q1" value="beach"> The beach</label>
  </div>
  <div class="question">
    <p>2. What is the writer’s role?</p>
    <input id="a2t1_q2" class="short-answer" placeholder="Type your answer">
  </div>
  <div class="controls"><button id="btnA2T1">Submit</button></div>
  <div id="resultA2T1" class="result"></div>
</section>
  <!-- ======== A2T2 ======== -->
<section class="level" id="A2T2">
  <h2>A2 Test 2 – Reading</h2>
  <div class="passage">
    My first job was at a restaurant. It was not an easy start because I had no experience. But my manager helped me to learn the ropes and become efficient at my work.
  </div>
  <div class="question">
    <p>1. What did the writer not have?</p>
    <label><input type="radio" name="a2t2_q1" value="experience"> Experience</label>
    <label><input type="radio" name="a2t2_q1" value="money"> Money</label>
  </div>
  <div class="question">
    <p>2. What did the manager help the writer to do?</p>
    <input id="a2t2_q2" class="short-answer" placeholder="Type your answer">
  </div>
  <div class="controls"><button id="btnA2T2">Submit</button></div>
  <div id="resultA2T2" class="result"></div>
</section>

<!-- ======== A2T3 ======== -->
<section class="level" id="A2T3">
  <h2>A2 Test 3 – Workplace Interaction</h2>
  <div class="passage">
    You have a co-worker, Alex, who often criticizes your work in front of others. You feel uncomfortable but want to solve the problem politely. You decide to talk to Alex after work.
  </div>
  <div class="question">
    <p>1. What is the best way to start your conversation with Alex?</p>
    <label><input type="radio" name="a2t3_q1" value="a"> "You always embarrass me in front of people!"</label>
    <label><input type="radio" name="a2t3_q1" value="b"> "Can we talk for a minute? I’d like to understand your feedback better."</label>
    <label><input type="radio" name="a2t3_q1" value="c"> "I don’t care what you think about my work."</label>
    <label><input type="radio" name="a2t3_q1" value="d"> "Why do you always have to complain?"</label>
  </div>
  <div class="controls"><button id="btnA2T3">Submit</button></div>
  <div id="resultA2T3" class="result"></div>
</section>

  <!-- ======== B1T1 ======== -->
<section class="level" id="B1T1">
  <h2>B1 Test 1 – Reading</h2>
  <div class="passage">
    Learning another language can be difficult, but it gives you more opportunities to communicate effectively, especially in the workplace. That is why many companies look for employees who can communicate in different languages.
  </div>
  <div class="question">
    <p>1. What do many companies look for?</p>
    <label><input type="radio" name="b1t1_q1" value="language"> People who can speak other languages</label>
    <label><input type="radio" name="b1t1_q1" value="friends"> People with many friends</label>
  </div>
  <div class="question">
    <p>2. What do languages help people to do?</p>
    <input id="b1t1_q2" class="short-answer" placeholder="Type your answer">
  </div>
  <div class="controls"><button id="btnB1T1">Submit</button></div>
  <div id="resultB1T1" class="result"></div>
</section>

  <!-- ======== B1T2 ======== -->
<section class="level" id="B1T2">
  <h2>B1 Test 2 – Reading</h2>
  <div class="passage">
    Before using any equipment, workers must be aware of the safety rules, like wearing gloves, goggles, and helmets to prevent serious injuries.
  </div>
  <div class="question">
    <p>1. What should workers know before using equipment?</p>
    <label><input type="radio" name="b1t2_q1" value="rules"> injuries</label>
    <label><input type="radio" name="b1t2_q1" value="safety"> safety rules</label>
  </div>
  <div class="question">
    <p>2. Name the safety rule mentioned.</p>
    <input id="b1t2_q2" class="short-answer" placeholder="Type your answer">
  </div>
  <div class="controls"><button id="btnB1T2">Submit</button></div>
  <div id="resultB1T2" class="result"></div>
</section>

  <!-- ======== B1T3 ======== -->
<section class="level" id="B1T3">
  <h2>B1 Test 3 – Reading</h2>
  <div class="passage">
    A client complained about a delay in delivery. As a leader, you need to respond to the client and explain that your team is already fixing the issue.
  </div>
  <div class="question">
    <p>1. What should the team leader do in the email?</p>
    <input id="b1t3_q1" class="short-answer" placeholder="Type your answer">
  </div>
  <div class="controls"><button id="btnB1T3">Submit</button></div>
  <div id="resultB1T3" class="result"></div>
</section>

<!-- ======== Writing Essay ======== -->
<section class="level" id="Essay">
  <h2>Writing Task 1 – Essay</h2>
  <p>Write an essay not less than 100 words: <strong>Why learning English is important for your future job.</strong></p>
  <textarea id="essayText" placeholder="Write your essay here..."></textarea>
  <div class="examiner-inputs">
    <strong>Examiner Partial Credit:</strong>
    <label>Formatting: <input type="number" id="essayFormat" min="0" max="5"></label>
    <label>Structure: <input type="number" id="essayStructure" min="0" max="5"></label>
    <label>Grammar: <input type="number" id="essayGrammar" min="0" max="5"></label>
    <label>Vocabulary: <input type="number" id="essayVocab" min="0" max="5"></label>
  </div>
  <div class="controls"><button id="btnEssay">Submit</button></div>
  <div id="resultEssay" class="result"></div>
</section>

<!-- ======== Writing Email ======== -->
<section class="level" id="Email">
  <h2>Writing Task 2 – Email</h2>
  <p>Your team leader emailed you about a mentorship program for the new apprentice, Leonard. <strong>Write your email reply not less than 40 words.</strong></p>
  <textarea id="emailText" placeholder="Write your email here..."></textarea>
  <div class="examiner-inputs">
    <strong>Examiner Partial Credit:</strong>
    <label>Formatting: <input type="number" id="emailFormat" min="0" max="5"></label>
    <label>Structure: <input type="number" id="emailStructure" min="0" max="5"></label>
    <label>Grammar: <input type="number" id="emailGrammar" min="0" max="5"></label>
    <label>Vocabulary: <input type="number" id="emailVocab" min="0" max="5"></label>
  </div>
  <div class="controls"><button id="btnEmail">Submit</button></div>
  <div id="resultEmail" class="result"></div>
</section>
  

<!-- ======== Final Instructions ======== -->
<div class="hint" id="finalInstructions">
  <strong>Final instructions (candidates):</strong>
  <ol>
    <li>Type your <strong>full name</strong> in the Candidate Name field at the top.</li>
    <li>When you have finished all sections, click <strong>Save Results to PDF</strong>. The file will be saved to your device.</li>
    <li>Send the PDF to: <strong>susan.centino@cirrusrecruitment.com</strong> or Messenger.</li>
  </ol>
</div>

<footer>
  <button id="btnSavePDF">Save Results to PDF</button>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const getRadioScore = (name, val) => {
    const r = document.querySelector('input[name="'+name+'"]:checked');
    return r && r.value === val ? 1 : 0;
  };
  const getTextScore = (id, ans) => {
    const t = document.getElementById(id).value.trim().toLowerCase();
    return t.includes(ans) ? 1 : 0;
  };
  const wordCount = s => s.trim().split(/\s+/).filter(Boolean).length;

  // Reading Tests
  const readingTests = [
    {btn:'btnA1T1',id:'A1T1',score:()=>getRadioScore('a1t1_q1','6')+getRadioScore('a1t1_q2','mark')+getTextScore('a1t1_q3','bus')},
    {btn:'btnA1T2',id:'A1T2',score:()=>getRadioScore('a1t2_q1','plumber')+getTextScore('a1t2_q2','12:30')},
    {btn:'btnA2T1',id:'A2T1',score:()=>getRadioScore('a2t1_q1','beach')+getTextScore('a2t1_q2','leader')},
    {btn:'btnA2T2',id:'A2T2',score:()=>getRadioScore('a2t2_q1','experience')+getTextScore('a2t2_q2','start')},
    {btn:'btnA2T3',id:'A2T3',score:()=>getRadioScore('a2t3_q1','b')},
    {btn:'btnB1T1',id:'B1T1',score:()=>getRadioScore('b1t1_q1','language')+getTextScore('b1t1_q2','communicate')},
    {btn:'btnB1T2',id:'B1T2',score:()=>getRadioScore('b1t2_q1','safety')+getTextScore('b1t2_q2','wearing')},
    {btn:'btnB1T3',id:'B1T3',score:()=>getTextScore('b1t3_q1','apologize')+getTextScore('b1t3_q1','sorry')}
  ];

  readingTests.forEach(t=>{
    const btn=document.getElementById(t.btn);
    if(btn){
      btn.addEventListener('click',()=>{
        const s=t.score();
        document.getElementById('result'+t.id).innerHTML=`<strong>Score:</strong> ${s}`;
      });
    }
  });

  // Writing Word Count + Examiner Partial Scores
  function writingScoreAndLevel(w){
    if(w<10)return{score:0,level:'Below A1'};
    if(w<20)return{score:1,level:'A1'};
    if(w<50)return{score:2,level:'A2'};
    if(w<100)return{score:3,level:'B1'};
    if(w<200)return{score:4,level:'B2'};
    return{score:5,level:'C1'};
  }

  function showWritingEvaluation(sectionId, textId, resultId){
    const writingText=document.getElementById(textId).value.trim();
    const wc=writingText.split(/\s+/).filter(Boolean).length;
    const auto=writingScoreAndLevel(wc);
    const container=document.getElementById(resultId);
    container.innerHTML=`
      <p><strong>Word Count:</strong> ${wc}</p>
      <p><strong>Auto Level:</strong> ${auto.level} (Base Score: ${auto.score})</p>
      <hr>
      <h4>Examiner Partial Credits (0–5 each)</h4>
      <label>Formatting: <input type="number" id="${sectionId}_fmt" min="0" max="5" value="0"></label><br>
      <label>Structure: <input type="number" id="${sectionId}_str" min="0" max="5" value="0"></label><br>
      <label>Grammar: <input type="number" id="${sectionId}_grm" min="0" max="5" value="0"></label><br>
      <label>Vocabulary: <input type="number" id="${sectionId}_vocab" min="0" max="5" value="0"></label><br><br>
      <button onclick="computeFinalWritingScore('${sectionId}', ${auto.score})">Compute Final Score</button>
      <div id="${sectionId}_final" style="margin-top:10px;font-weight:bold;"></div>
    `;
  }

  window.computeFinalWritingScore = function(sectionId, baseScore){
    const fmt=+document.getElementById(sectionId+"_fmt").value||0;
    const str=+document.getElementById(sectionId+"_str").value||0;
    const grm=+document.getElementById(sectionId+"_grm").value||0;
    const vocab=+document.getElementById(sectionId+"_vocab").value||0;
    const total=baseScore+fmt+str+grm+vocab;
    document.getElementById(sectionId+"_final").innerText=`Total Adjusted Score: ${total}/25`;
  };

  // Essay
  document.getElementById('btnEssay').addEventListener('click',()=>{
    showWritingEvaluation('essay','essayText','resultEssay');
  });

  // Email
  document.getElementById('btnEmail').addEventListener('click',()=>{
    showWritingEvaluation('email','emailText','resultEmail');
  });

});
  // Add global writingScoreAndLevel before PDF save
  function writingScoreAndLevel(w){
    if(w < 10) return {score:0, level:'Below A1'};
    if(w < 20) return {score:1, level:'A1'};
    if(w <= 50) return {score:2, level:'A2'};
    if(w <= 100) return {score:3, level:'B1'};
    if(w <= 200) return {score:4, level:'B2'};
    return {score:5, level:'C1'};
  }

  // --- PDF GENERATION SECTION ---
  document.getElementById('btnSavePDF').addEventListener('click', async () => {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    let y = 15;
    doc.setFontSize(14);
    doc.text("Skilled-Jobs English Test Results", 105, y, { align: "center" });
    y += 10;
    doc.setFontSize(11);

    // Reading Test Results
    doc.text("Reading Test Results:", 10, y);
    y += 8;
    const tests = document.querySelectorAll(".level");
    tests.forEach(section => {
      const title = section.querySelector("h2")?.innerText || "";
      const result = section.querySelector(".result")?.innerText || "Not answered";
      if (title.includes("Test")) {
        doc.text(`${title}: ${result}`, 10, y);
        y += 7;
      }
    });

    // Essay Section
    y += 8;
    const essayText = document.getElementById("essayText").value.trim();
    const essayWords = essayText.split(/\s+/).filter(Boolean).length;
    const essayLevel = writingScoreAndLevel(essayWords);
    doc.text("Writing Task 1 – Essay", 10, y); y += 7;
    doc.text(`Word count: ${essayWords} | Level: ${essayLevel.level}`, 10, y); y += 7;
    doc.text("Response:", 10, y); y += 7;
    const essayLines = doc.splitTextToSize(essayText || "No response.", 180);
    doc.text(essayLines, 10, y);
    y += essayLines.length * 7;

    // Email Section
    y += 10;
    const emailText = document.getElementById("emailText").value.trim();
    const emailWords = emailText.split(/\s+/).filter(Boolean).length;
    const emailLevel = writingScoreAndLevel(emailWords);
    doc.text("Writing Task 2 – Email", 10, y); y += 7;
    doc.text(`Word count: ${emailWords} | Level: ${emailLevel.level}`, 10, y); y += 7;
    doc.text("Response:", 10, y); y += 7;
    const emailLines = doc.splitTextToSize(emailText || "No response.", 180);
    doc.text(emailLines, 10, y);
    y += emailLines.length * 7;

    // Summary
    y += 10;
    doc.setFontSize(12);
    doc.text("Final Summary", 10, y);
    y += 7;

    const totalReading = [...document.querySelectorAll('.result')]
      .filter(r => r.innerText.includes('Score'))
      .map(r => {
        const m = r.innerText.match(/Score:\s*(\d+)/);
        return m ? parseInt(m[1]) : 0;
      });

    const avgReading = totalReading.length ?
      (totalReading.reduce((a,b)=>a+b,0)/totalReading.length).toFixed(1) : 0;

    // CEFR interpretation
    function readingLevelFromScore(score) {
      if (score < 0.5) return { level: 'Below A1', percent: '0–19%' }
      if (score < 1.5) return { level: 'A1', percent: '20–39%' };
      if (score < 2.5) return { level: 'A2', percent: '40–59%' };
      if (score < 3.5) return { level: 'B1', percent: '60–74%' };
      if (score < 4.5) return { level: 'B2', percent: '75–89%' };
      return { level: 'C1', percent: '90–100%' };
    }
    const avgInfo = readingLevelFromScore(avgReading);

    // --- Output summary ---
    doc.setFontSize(11);
    doc.text(`Average Reading Score: ${avgReading} (${avgInfo.level}, ${avgInfo.percent})`, 10, y);
    y += 7;
    doc.text(`Essay Level: ${essayLevel.level}`, 10, y);
    y += 7;
    doc.text(`Email Level: ${emailLevel.level}`, 10, y);

    // Save
    doc.save("English_Test_Results.pdf");
  });
});
</script>
</html>
