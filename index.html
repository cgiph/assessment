<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skilled-Jobs English: Reading & Writing Tests</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#0f172a;}
    body{max-width:900px;margin:28px auto;padding:20px;background:#fff}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:1.25rem;margin:0}
    .name-field{font-size:0.95rem;border:1px solid #cbd5e1;border-radius:6px;padding:6px;width:260px}
    .level{border:1px solid #dbe7f7;border-radius:8px;padding:14px;margin:18px 0;background:#ffffff}
    h2{font-size:1.05rem;margin:6px 0}
    .passage{background:#fafafa;padding:10px;border-radius:6px;border:1px solid #eef2f7;margin-bottom:10px;font-size:0.95rem}
    .question{margin:8px 0;padding:8px;border-left:3px solid #e6eef8;background:transparent;border-radius:4px}
    label{display:block;cursor:pointer;margin:3px 0}
    .short-answer{width:100%;min-height:44px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{background:#0f172a;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    .result{margin-top:12px;padding:10px;border-radius:6px;background:#f8fafc;border:1px solid #e6eef8;font-size:0.95rem}
    textarea{width:100%;min-height:140px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .hint{font-size:0.9rem;color:#0f172a;background:#fbfbfb;padding:10px;border-radius:6px;border:1px solid #eef2f7}
    footer{margin-top:22px;font-size:0.9rem;color:#334155}
    .hidden{display:none}
    @media (max-width:700px){header{flex-direction:column;align-items:flex-start} .name-field{width:100%}}
  </style>
</head>
<body>
  <header>
    <h1>Skilled-Jobs English — Reading & Writing</h1>
    <div>
      <label for="candidateName"><strong>Candidate Name:</strong></label><br>
      <input id="candidateName" class="name-field" type="text" placeholder="Write your full name here">
    </div>
  </header>

  <p class="hint"><strong>Instructions:</strong> Complete all sections. After finishing, follow Final Instructions at the bottom to export your results and send them to the examiner.</p>

  <!-- ========== READING & WRITING TEST SECTIONS (SAME AS YOUR CODE) ========== -->
  <!-- (omitted here for brevity since your content was already correct) -->
  <!-- Keep all <section> ... </section> blocks exactly as you had them -->

  <!-- Final Instructions + Footer -->
  <div class="hint" id="finalInstructions">
    <strong>Final instructions (candidates):</strong>
    <ol>
      <li>Type your <strong>full name</strong> in the Candidate Name field at the top.</li>
      <li>When you have finished all sections, press <strong>Ctrl + Alt + E</strong> to unlock Examiner Tools.</li>
      <li>Click <strong>Export Results to PDF</strong>. Save the file as PDF when prompted.</li>
      <li>Send the saved PDF to: <strong>susan.centino@cirrusrecruitment.com</strong>.</li>
    </ol>
  </div>

  <footer>
    <p>Results are saved locally on your device. Examiner tools (clear/export) are hidden until unlocked.</p>
    <div id="adminControls" class="hidden">
      <button id="btnClearData">Clear Candidate Data</button>
      <button id="btnExportPDF">Export Results to PDF</button>
    </div>
    <div id="postExportMsg" class="result hidden" aria-live="polite"></div>
  </footer>

  <script>
    /* ===== Helper functions ===== */
    function normalize(s){return String(s||'').trim().toLowerCase();}
    function wordsCount(s){return s.trim().split(/\s+/).filter(Boolean).length;}

    function persist(name,key,value){
      if(!name) name='(No name)';
      const storeKey='skilledtest_'+name;
      let obj={};
      try{obj=JSON.parse(localStorage.getItem(storeKey))||{};}catch(e){}
      obj[key]=value;
      localStorage.setItem(storeKey,JSON.stringify(obj));
    }

    function loadStored(name){
      if(!name) name='(No name)';
      try{return JSON.parse(localStorage.getItem('skilledtest_'+name))||{};}catch(e){return {};}
    }

    function saveResult(domId,score,total,notes){
      const name=document.getElementById('candidateName').value.trim()||'(No name)';
      const el=document.getElementById(domId);
      el.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Score:</strong> ${score}/${total}<br><strong>Notes:</strong> ${notes.join(' ')}`;
      persist(name,domId,{score,total,notes,timestamp:new Date().toISOString()});
      updateOverallSummary(name);
    }

    function updateOverallSummary(name){
      const data=loadStored(name);
      let gained=0,possible=0;
      for(const k in data){
        if(data[k]&&typeof data[k].score==='number'){gained+=data[k].score;possible+=data[k].total;}
      }
      let summaryEl=document.getElementById('overallSummary');
      if(!summaryEl){
        summaryEl=document.createElement('div');
        summaryEl.id='overallSummary';
        summaryEl.className='result';
        document.body.appendChild(summaryEl);
      }
      if(possible>0){
        const pct=Math.round((gained/possible)*100);
        let level='Unassessed';
        if(pct>=85) level='B1+'; else if(pct>=70) level='B1'; else if(pct>=50) level='A2'; else level='A1 or below';
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Total:</strong> ${gained}/${possible} (${pct}%)<br><strong>Suggested level:</strong> ${level}`;
        persist(name,'overallSummary',{score:gained,total:possible,pct,level,timestamp:new Date().toISOString()});
      } else {
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><em>No submissions yet.</em>`;
      }
    }

    /* ===== Examiner mode ===== */
    function enableExaminerMode(){
      document.getElementById('adminControls').classList.remove('hidden');
      alert('Examiner mode enabled. Clear and Export buttons are now visible.');
    }

    function clearCandidateData(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Enter candidate name first.');return;}
      if(confirm(`Clear all saved data for "${name}"?`)){
        localStorage.removeItem('skilledtest_'+name);
        ['resA1T1','resA1T2','resA2T1','resA2T2','resB1T1','resB1T2','resEssay','resEmail','overallSummary'].forEach(id=>{
          const el=document.getElementById(id);
          if(el) el.innerHTML='';
        });
        alert('Data cleared for '+name);
      }
    }

    function confirmAndExport(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Please enter your name first.');return;}
      if(!confirm(`Export results for "${name}"?`)) return;

      const data=loadStored(name);
      const safeName=name.replace(/[^a-z0-9_\- ]/ig,'').replace(/\s+/g,'_');
      const filename=`SkilledJobs_EnglishResults_${safeName}.pdf`;

      let html=`<div style="font-family:system-ui,Segoe UI,Roboto,Arial;max-width:780px;margin:20px auto;color:#0f172a;">`;
      html+=`<h1>Skilled-Jobs English — Results</h1>`;
      html+=`<p><strong>Candidate:</strong> ${name}<br><strong>Generated:</strong> ${new Date().toLocaleString()}</p>`;

      for(const key in data){
        const d=data[key];
        if(d && d.score!==undefined){
          html+=`<hr><h3>${key}</h3><p><strong>Score:</strong> ${d.score}/${d.total}<br><strong>Notes:</strong> ${(d.notes||[]).join(' ')}</p>`;
        }
      }

      html+=`<hr><p><em>Send this PDF to: susan.centino@cirrusrecruitment.com</em></p></div>`;
      const win=window.open('', '_blank');
      win.document.write(`<html><head><title>${filename}</title><meta charset="utf-8"></head><body>${html}</body></html>`);
      win.document.close();
      setTimeout(()=>{win.print();},500);

      const post=document.getElementById('postExportMsg');
      post.classList.remove('hidden');
      post.innerHTML=`✅ <strong>Export complete.</strong> Please send your PDF to the examiner.`;
    }

    /* ===== Keyboard shortcut ===== */
    document.addEventListener('keydown',e=>{
      if(e.ctrlKey && e.altKey && (e.key==='E'||e.key==='e')) enableExaminerMode();
    });

    /* ===== Initialize ===== */
    document.addEventListener('DOMContentLoaded',()=>{
      document.getElementById('candidateName').addEventListener('blur',function(){
        const n=this.value.trim();
        if(n) updateOverallSummary(n);
      });

      // Hook up grader buttons
      document.getElementById('btnA1T1')?.addEventListener('click',gradeA1T1);
      document.getElementById('btnA1T2')?.addEventListener('click',gradeA1T2);
      document.getElementById('btnA2T1')?.addEventListener('click',gradeA2T1);
      document.getElementById('btnA2T2')?.addEventListener('click',gradeA2T2);
      document.getElementById('btnB1T1')?.addEventListener('click',gradeB1T1);
      document.getElementById('btnB1T2')?.addEventListener('click',gradeB1T2);
      document.getElementById('btnEssay')?.addEventListener('click',gradeEssay);
      document.getElementById('btnEmail')?.addEventListener('click',gradeEmail);
      document.getElementById('btnClearData')?.addEventListener('click',clearCandidateData);
      document.getElementById('btnExportPDF')?.addEventListener('click',confirmAndExport);
    });
  </script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skilled-Jobs English: Reading & Writing Tests</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#0f172a;}
    body{max-width:900px;margin:28px auto;padding:20px;background:#fff}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:1.25rem;margin:0}
    .name-field{font-size:0.95rem;border:1px solid #cbd5e1;border-radius:6px;padding:6px;width:260px}
    .level{border:1px solid #dbe7f7;border-radius:8px;padding:14px;margin:18px 0;background:#ffffff}
    h2{font-size:1.05rem;margin:6px 0}
    .passage{background:#fafafa;padding:10px;border-radius:6px;border:1px solid #eef2f7;margin-bottom:10px;font-size:0.95rem}
    .question{margin:8px 0;padding:8px;border-left:3px solid #e6eef8;background:transparent;border-radius:4px}
    label{display:block;cursor:pointer;margin:3px 0}
    .short-answer{width:100%;min-height:44px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{background:#0f172a;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    .result{margin-top:12px;padding:10px;border-radius:6px;background:#f8fafc;border:1px solid #e6eef8;font-size:0.95rem}
    textarea{width:100%;min-height:140px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .hint{font-size:0.9rem;color:#0f172a;background:#fbfbfb;padding:10px;border-radius:6px;border:1px solid #eef2f7}
    footer{margin-top:22px;font-size:0.9rem;color:#334155}
    .hidden{display:none}
    @media (max-width:700px){header{flex-direction:column;align-items:flex-start} .name-field{width:100%}}
  </style>
</head>
<body>
  <header>
    <h1>Skilled-Jobs English — Reading & Writing</h1>
    <div>
      <label for="candidateName"><strong>Candidate Name:</strong></label><br>
      <input id="candidateName" class="name-field" type="text" placeholder="Write your full name here">
    </div>
  </header>

  <p class="hint"><strong>Instructions:</strong> Complete all sections. After finishing, follow Final Instructions at the bottom to export your results and send them to the examiner.</p>

  <!-- ========== READING & WRITING TEST SECTIONS (SAME AS YOUR CODE) ========== -->
  <!-- (omitted here for brevity since your content was already correct) -->
  <!-- Keep all <section> ... </section> blocks exactly as you had them -->

  <!-- Final Instructions + Footer -->
  <div class="hint" id="finalInstructions">
    <strong>Final instructions (candidates):</strong>
    <ol>
      <li>Type your <strong>full name</strong> in the Candidate Name field at the top.</li>
      <li>When you have finished all sections, press <strong>Ctrl + Alt + E</strong> to unlock Examiner Tools.</li>
      <li>Click <strong>Export Results to PDF</strong>. Save the file as PDF when prompted.</li>
      <li>Send the saved PDF to: <strong>susan.centino@cirrusrecruitment.com</strong>.</li>
    </ol>
  </div>

  <footer>
    <p>Results are saved locally on your device. Examiner tools (clear/export) are hidden until unlocked.</p>
    <div id="adminControls" class="hidden">
      <button id="btnClearData">Clear Candidate Data</button>
      <button id="btnExportPDF">Export Results to PDF</button>
    </div>
    <div id="postExportMsg" class="result hidden" aria-live="polite"></div>
  </footer>

  <script>
    /* ===== Helper functions ===== */
    function normalize(s){return String(s||'').trim().toLowerCase();}
    function wordsCount(s){return s.trim().split(/\s+/).filter(Boolean).length;}

    function persist(name,key,value){
      if(!name) name='(No name)';
      const storeKey='skilledtest_'+name;
      let obj={};
      try{obj=JSON.parse(localStorage.getItem(storeKey))||{};}catch(e){}
      obj[key]=value;
      localStorage.setItem(storeKey,JSON.stringify(obj));
    }

    function loadStored(name){
      if(!name) name='(No name)';
      try{return JSON.parse(localStorage.getItem('skilledtest_'+name))||{};}catch(e){return {};}
    }

    function saveResult(domId,score,total,notes){
      const name=document.getElementById('candidateName').value.trim()||'(No name)';
      const el=document.getElementById(domId);
      el.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Score:</strong> ${score}/${total}<br><strong>Notes:</strong> ${notes.join(' ')}`;
      persist(name,domId,{score,total,notes,timestamp:new Date().toISOString()});
      updateOverallSummary(name);
    }

    function updateOverallSummary(name){
      const data=loadStored(name);
      let gained=0,possible=0;
      for(const k in data){
        if(data[k]&&typeof data[k].score==='number'){gained+=data[k].score;possible+=data[k].total;}
      }
      let summaryEl=document.getElementById('overallSummary');
      if(!summaryEl){
        summaryEl=document.createElement('div');
        summaryEl.id='overallSummary';
        summaryEl.className='result';
        document.body.appendChild(summaryEl);
      }
      if(possible>0){
        const pct=Math.round((gained/possible)*100);
        let level='Unassessed';
        if(pct>=85) level='B1+'; else if(pct>=70) level='B1'; else if(pct>=50) level='A2'; else level='A1 or below';
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Total:</strong> ${gained}/${possible} (${pct}%)<br><strong>Suggested level:</strong> ${level}`;
        persist(name,'overallSummary',{score:gained,total:possible,pct,level,timestamp:new Date().toISOString()});
      } else {
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><em>No submissions yet.</em>`;
      }
    }

    /* ===== Examiner mode ===== */
    function enableExaminerMode(){
      document.getElementById('adminControls').classList.remove('hidden');
      alert('Examiner mode enabled. Clear and Export buttons are now visible.');
    }

    function clearCandidateData(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Enter candidate name first.');return;}
      if(confirm(`Clear all saved data for "${name}"?`)){
        localStorage.removeItem('skilledtest_'+name);
        ['resA1T1','resA1T2','resA2T1','resA2T2','resB1T1','resB1T2','resEssay','resEmail','overallSummary'].forEach(id=>{
          const el=document.getElementById(id);
          if(el) el.innerHTML='';
        });
        alert('Data cleared for '+name);
      }
    }

    function confirmAndExport(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Please enter your name first.');return;}
      if(!confirm(`Export results for "${name}"?`)) return;

      const data=loadStored(name);
      const safeName=name.replace(/[^a-z0-9_\- ]/ig,'').replace(/\s+/g,'_');
      const filename=`SkilledJobs_EnglishResults_${safeName}.pdf`;

      let html=`<div style="font-family:system-ui,Segoe UI,Roboto,Arial;max-width:780px;margin:20px auto;color:#0f172a;">`;
      html+=`<h1>Skilled-Jobs English — Results</h1>`;
      html+=`<p><strong>Candidate:</strong> ${name}<br><strong>Generated:</strong> ${new Date().toLocaleString()}</p>`;

      for(const key in data){
        const d=data[key];
        if(d && d.score!==undefined){
          html+=`<hr><h3>${key}</h3><p><strong>Score:</strong> ${d.score}/${d.total}<br><strong>Notes:</strong> ${(d.notes||[]).join(' ')}</p>`;
        }
      }

      html+=`<hr><p><em>Send this PDF to: susan.centino@cirrusrecruitment.com</em></p></div>`;
      const win=window.open('', '_blank');
      win.document.write(`<html><head><title>${filename}</title><meta charset="utf-8"></head><body>${html}</body></html>`);
      win.document.close();
      setTimeout(()=>{win.print();},500);

      const post=document.getElementById('postExportMsg');
      post.classList.remove('hidden');
      post.innerHTML=`✅ <strong>Export complete.</strong> Please send your PDF to the examiner.`;
    }

    /* ===== Keyboard shortcut ===== */
    document.addEventListener('keydown',e=>{
      if(e.ctrlKey && e.altKey && (e.key==='E'||e.key==='e')) enableExaminerMode();
    });

    /* ===== Initialize ===== */
    document.addEventListener('DOMContentLoaded',()=>{
      document.getElementById('candidateName').addEventListener('blur',function(){
        const n=this.value.trim();
        if(n) updateOverallSummary(n);
      });

      // Hook up grader buttons
      document.getElementById('btnA1T1')?.addEventListener('click',gradeA1T1);
      document.getElementById('btnA1T2')?.addEventListener('click',gradeA1T2);
      document.getElementById('btnA2T1')?.addEventListener('click',gradeA2T1);
      document.getElementById('btnA2T2')?.addEventListener('click',gradeA2T2);
      document.getElementById('btnB1T1')?.addEventListener('click',gradeB1T1);
      document.getElementById('btnB1T2')?.addEventListener('click',gradeB1T2);
      document.getElementById('btnEssay')?.addEventListener('click',gradeEssay);
      document.getElementById('btnEmail')?.addEventListener('click',gradeEmail);
      document.getElementById('btnClearData')?.addEventListener('click',clearCandidateData);
      document.getElementById('btnExportPDF')?.addEventListener('click',confirmAndExport);
    });
  </script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skilled-Jobs English: Reading & Writing Tests</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#0f172a;}
    body{max-width:900px;margin:28px auto;padding:20px;background:#fff}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:1.25rem;margin:0}
    .name-field{font-size:0.95rem;border:1px solid #cbd5e1;border-radius:6px;padding:6px;width:260px}
    .level{border:1px solid #dbe7f7;border-radius:8px;padding:14px;margin:18px 0;background:#ffffff}
    h2{font-size:1.05rem;margin:6px 0}
    .passage{background:#fafafa;padding:10px;border-radius:6px;border:1px solid #eef2f7;margin-bottom:10px;font-size:0.95rem}
    .question{margin:8px 0;padding:8px;border-left:3px solid #e6eef8;background:transparent;border-radius:4px}
    label{display:block;cursor:pointer;margin:3px 0}
    .short-answer{width:100%;min-height:44px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{background:#0f172a;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    .result{margin-top:12px;padding:10px;border-radius:6px;background:#f8fafc;border:1px solid #e6eef8;font-size:0.95rem}
    textarea{width:100%;min-height:140px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .hint{font-size:0.9rem;color:#0f172a;background:#fbfbfb;padding:10px;border-radius:6px;border:1px solid #eef2f7}
    footer{margin-top:22px;font-size:0.9rem;color:#334155}
    .hidden{display:none}
    @media (max-width:700px){header{flex-direction:column;align-items:flex-start} .name-field{width:100%}}
  </style>
</head>
<body>
  <header>
    <h1>Skilled-Jobs English — Reading & Writing</h1>
    <div>
      <label for="candidateName"><strong>Candidate Name:</strong></label><br>
      <input id="candidateName" class="name-field" type="text" placeholder="Write your full name here">
    </div>
  </header>

  <p class="hint"><strong>Instructions:</strong> Complete all sections. After finishing, follow Final Instructions at the bottom to export your results and send them to the examiner.</p>

  <!-- ========== READING & WRITING TEST SECTIONS (SAME AS YOUR CODE) ========== -->
  <!-- (omitted here for brevity since your content was already correct) -->
  <!-- Keep all <section> ... </section> blocks exactly as you had them -->

  <!-- Final Instructions + Footer -->
  <div class="hint" id="finalInstructions">
    <strong>Final instructions (candidates):</strong>
    <ol>
      <li>Type your <strong>full name</strong> in the Candidate Name field at the top.</li>
      <li>When you have finished all sections, press <strong>Ctrl + Alt + E</strong> to unlock Examiner Tools.</li>
      <li>Click <strong>Export Results to PDF</strong>. Save the file as PDF when prompted.</li>
      <li>Send the saved PDF to: <strong>susan.centino@cirrusrecruitment.com</strong>.</li>
    </ol>
  </div>

  <footer>
    <p>Results are saved locally on your device. Examiner tools (clear/export) are hidden until unlocked.</p>
    <div id="adminControls" class="hidden">
      <button id="btnClearData">Clear Candidate Data</button>
      <button id="btnExportPDF">Export Results to PDF</button>
    </div>
    <div id="postExportMsg" class="result hidden" aria-live="polite"></div>
  </footer>

  <script>
    /* ===== Helper functions ===== */
    function normalize(s){return String(s||'').trim().toLowerCase();}
    function wordsCount(s){return s.trim().split(/\s+/).filter(Boolean).length;}

    function persist(name,key,value){
      if(!name) name='(No name)';
      const storeKey='skilledtest_'+name;
      let obj={};
      try{obj=JSON.parse(localStorage.getItem(storeKey))||{};}catch(e){}
      obj[key]=value;
      localStorage.setItem(storeKey,JSON.stringify(obj));
    }

    function loadStored(name){
      if(!name) name='(No name)';
      try{return JSON.parse(localStorage.getItem('skilledtest_'+name))||{};}catch(e){return {};}
    }

    function saveResult(domId,score,total,notes){
      const name=document.getElementById('candidateName').value.trim()||'(No name)';
      const el=document.getElementById(domId);
      el.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Score:</strong> ${score}/${total}<br><strong>Notes:</strong> ${notes.join(' ')}`;
      persist(name,domId,{score,total,notes,timestamp:new Date().toISOString()});
      updateOverallSummary(name);
    }

    function updateOverallSummary(name){
      const data=loadStored(name);
      let gained=0,possible=0;
      for(const k in data){
        if(data[k]&&typeof data[k].score==='number'){gained+=data[k].score;possible+=data[k].total;}
      }
      let summaryEl=document.getElementById('overallSummary');
      if(!summaryEl){
        summaryEl=document.createElement('div');
        summaryEl.id='overallSummary';
        summaryEl.className='result';
        document.body.appendChild(summaryEl);
      }
      if(possible>0){
        const pct=Math.round((gained/possible)*100);
        let level='Unassessed';
        if(pct>=85) level='B1+'; else if(pct>=70) level='B1'; else if(pct>=50) level='A2'; else level='A1 or below';
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Total:</strong> ${gained}/${possible} (${pct}%)<br><strong>Suggested level:</strong> ${level}`;
        persist(name,'overallSummary',{score:gained,total:possible,pct,level,timestamp:new Date().toISOString()});
      } else {
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><em>No submissions yet.</em>`;
      }
    }

    /* ===== Examiner mode ===== */
    function enableExaminerMode(){
      document.getElementById('adminControls').classList.remove('hidden');
      alert('Examiner mode enabled. Clear and Export buttons are now visible.');
    }

    function clearCandidateData(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Enter candidate name first.');return;}
      if(confirm(`Clear all saved data for "${name}"?`)){
        localStorage.removeItem('skilledtest_'+name);
        ['resA1T1','resA1T2','resA2T1','resA2T2','resB1T1','resB1T2','resEssay','resEmail','overallSummary'].forEach(id=>{
          const el=document.getElementById(id);
          if(el) el.innerHTML='';
        });
        alert('Data cleared for '+name);
      }
    }

    function confirmAndExport(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Please enter your name first.');return;}
      if(!confirm(`Export results for "${name}"?`)) return;

      const data=loadStored(name);
      const safeName=name.replace(/[^a-z0-9_\- ]/ig,'').replace(/\s+/g,'_');
      const filename=`SkilledJobs_EnglishResults_${safeName}.pdf`;

      let html=`<div style="font-family:system-ui,Segoe UI,Roboto,Arial;max-width:780px;margin:20px auto;color:#0f172a;">`;
      html+=`<h1>Skilled-Jobs English — Results</h1>`;
      html+=`<p><strong>Candidate:</strong> ${name}<br><strong>Generated:</strong> ${new Date().toLocaleString()}</p>`;

      for(const key in data){
        const d=data[key];
        if(d && d.score!==undefined){
          html+=`<hr><h3>${key}</h3><p><strong>Score:</strong> ${d.score}/${d.total}<br><strong>Notes:</strong> ${(d.notes||[]).join(' ')}</p>`;
        }
      }

      html+=`<hr><p><em>Send this PDF to: susan.centino@cirrusrecruitment.com</em></p></div>`;
      const win=window.open('', '_blank');
      win.document.write(`<html><head><title>${filename}</title><meta charset="utf-8"></head><body>${html}</body></html>`);
      win.document.close();
      setTimeout(()=>{win.print();},500);

      const post=document.getElementById('postExportMsg');
      post.classList.remove('hidden');
      post.innerHTML=`✅ <strong>Export complete.</strong> Please send your PDF to the examiner.`;
    }

    /* ===== Keyboard shortcut ===== */
    document.addEventListener('keydown',e=>{
      if(e.ctrlKey && e.altKey && (e.key==='E'||e.key==='e')) enableExaminerMode();
    });

    /* ===== Initialize ===== */
    document.addEventListener('DOMContentLoaded',()=>{
      document.getElementById('candidateName').addEventListener('blur',function(){
        const n=this.value.trim();
        if(n) updateOverallSummary(n);
      });

      // Hook up grader buttons
      document.getElementById('btnA1T1')?.addEventListener('click',gradeA1T1);
      document.getElementById('btnA1T2')?.addEventListener('click',gradeA1T2);
      document.getElementById('btnA2T1')?.addEventListener('click',gradeA2T1);
      document.getElementById('btnA2T2')?.addEventListener('click',gradeA2T2);
      document.getElementById('btnB1T1')?.addEventListener('click',gradeB1T1);
      document.getElementById('btnB1T2')?.addEventListener('click',gradeB1T2);
      document.getElementById('btnEssay')?.addEventListener('click',gradeEssay);
      document.getElementById('btnEmail')?.addEventListener('click',gradeEmail);
      document.getElementById('btnClearData')?.addEventListener('click',clearCandidateData);
      document.getElementById('btnExportPDF')?.addEventListener('click',confirmAndExport);
    });
  </script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skilled-Jobs English: Reading & Writing Tests</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#0f172a;}
    body{max-width:900px;margin:28px auto;padding:20px;background:#fff}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:1.25rem;margin:0}
    .name-field{font-size:0.95rem;border:1px solid #cbd5e1;border-radius:6px;padding:6px;width:260px}
    .level{border:1px solid #dbe7f7;border-radius:8px;padding:14px;margin:18px 0;background:#ffffff}
    h2{font-size:1.05rem;margin:6px 0}
    .passage{background:#fafafa;padding:10px;border-radius:6px;border:1px solid #eef2f7;margin-bottom:10px;font-size:0.95rem}
    .question{margin:8px 0;padding:8px;border-left:3px solid #e6eef8;background:transparent;border-radius:4px}
    label{display:block;cursor:pointer;margin:3px 0}
    .short-answer{width:100%;min-height:44px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{background:#0f172a;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    .result{margin-top:12px;padding:10px;border-radius:6px;background:#f8fafc;border:1px solid #e6eef8;font-size:0.95rem}
    textarea{width:100%;min-height:140px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .hint{font-size:0.9rem;color:#0f172a;background:#fbfbfb;padding:10px;border-radius:6px;border:1px solid #eef2f7}
    footer{margin-top:22px;font-size:0.9rem;color:#334155}
    .hidden{display:none}
    @media (max-width:700px){header{flex-direction:column;align-items:flex-start} .name-field{width:100%}}
  </style>
</head>
<body>
  <header>
    <h1>Skilled-Jobs English — Reading & Writing</h1>
    <div>
      <label for="candidateName"><strong>Candidate Name:</strong></label><br>
      <input id="candidateName" class="name-field" type="text" placeholder="Write your full name here">
    </div>
  </header>

  <p class="hint"><strong>Instructions:</strong> Complete all sections. After finishing, follow Final Instructions at the bottom to export your results and send them to the examiner.</p>

  <!-- ========== READING & WRITING TEST SECTIONS (SAME AS YOUR CODE) ========== -->
  <!-- (omitted here for brevity since your content was already correct) -->
  <!-- Keep all <section> ... </section> blocks exactly as you had them -->

  <!-- Final Instructions + Footer -->
  <div class="hint" id="finalInstructions">
    <strong>Final instructions (candidates):</strong>
    <ol>
      <li>Type your <strong>full name</strong> in the Candidate Name field at the top.</li>
      <li>When you have finished all sections, press <strong>Ctrl + Alt + E</strong> to unlock Examiner Tools.</li>
      <li>Click <strong>Export Results to PDF</strong>. Save the file as PDF when prompted.</li>
      <li>Send the saved PDF to: <strong>susan.centino@cirrusrecruitment.com</strong>.</li>
    </ol>
  </div>

  <footer>
    <p>Results are saved locally on your device. Examiner tools (clear/export) are hidden until unlocked.</p>
    <div id="adminControls" class="hidden">
      <button id="btnClearData">Clear Candidate Data</button>
      <button id="btnExportPDF">Export Results to PDF</button>
    </div>
    <div id="postExportMsg" class="result hidden" aria-live="polite"></div>
  </footer>

  <script>
    /* ===== Helper functions ===== */
    function normalize(s){return String(s||'').trim().toLowerCase();}
    function wordsCount(s){return s.trim().split(/\s+/).filter(Boolean).length;}

    function persist(name,key,value){
      if(!name) name='(No name)';
      const storeKey='skilledtest_'+name;
      let obj={};
      try{obj=JSON.parse(localStorage.getItem(storeKey))||{};}catch(e){}
      obj[key]=value;
      localStorage.setItem(storeKey,JSON.stringify(obj));
    }

    function loadStored(name){
      if(!name) name='(No name)';
      try{return JSON.parse(localStorage.getItem('skilledtest_'+name))||{};}catch(e){return {};}
    }

    function saveResult(domId,score,total,notes){
      const name=document.getElementById('candidateName').value.trim()||'(No name)';
      const el=document.getElementById(domId);
      el.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Score:</strong> ${score}/${total}<br><strong>Notes:</strong> ${notes.join(' ')}`;
      persist(name,domId,{score,total,notes,timestamp:new Date().toISOString()});
      updateOverallSummary(name);
    }

    function updateOverallSummary(name){
      const data=loadStored(name);
      let gained=0,possible=0;
      for(const k in data){
        if(data[k]&&typeof data[k].score==='number'){gained+=data[k].score;possible+=data[k].total;}
      }
      let summaryEl=document.getElementById('overallSummary');
      if(!summaryEl){
        summaryEl=document.createElement('div');
        summaryEl.id='overallSummary';
        summaryEl.className='result';
        document.body.appendChild(summaryEl);
      }
      if(possible>0){
        const pct=Math.round((gained/possible)*100);
        let level='Unassessed';
        if(pct>=85) level='B1+'; else if(pct>=70) level='B1'; else if(pct>=50) level='A2'; else level='A1 or below';
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Total:</strong> ${gained}/${possible} (${pct}%)<br><strong>Suggested level:</strong> ${level}`;
        persist(name,'overallSummary',{score:gained,total:possible,pct,level,timestamp:new Date().toISOString()});
      } else {
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><em>No submissions yet.</em>`;
      }
    }

    /* ===== Examiner mode ===== */
    function enableExaminerMode(){
      document.getElementById('adminControls').classList.remove('hidden');
      alert('Examiner mode enabled. Clear and Export buttons are now visible.');
    }

    function clearCandidateData(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Enter candidate name first.');return;}
      if(confirm(`Clear all saved data for "${name}"?`)){
        localStorage.removeItem('skilledtest_'+name);
        ['resA1T1','resA1T2','resA2T1','resA2T2','resB1T1','resB1T2','resEssay','resEmail','overallSummary'].forEach(id=>{
          const el=document.getElementById(id);
          if(el) el.innerHTML='';
        });
        alert('Data cleared for '+name);
      }
    }

    function confirmAndExport(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Please enter your name first.');return;}
      if(!confirm(`Export results for "${name}"?`)) return;

      const data=loadStored(name);
      const safeName=name.replace(/[^a-z0-9_\- ]/ig,'').replace(/\s+/g,'_');
      const filename=`SkilledJobs_EnglishResults_${safeName}.pdf`;

      let html=`<div style="font-family:system-ui,Segoe UI,Roboto,Arial;max-width:780px;margin:20px auto;color:#0f172a;">`;
      html+=`<h1>Skilled-Jobs English — Results</h1>`;
      html+=`<p><strong>Candidate:</strong> ${name}<br><strong>Generated:</strong> ${new Date().toLocaleString()}</p>`;

      for(const key in data){
        const d=data[key];
        if(d && d.score!==undefined){
          html+=`<hr><h3>${key}</h3><p><strong>Score:</strong> ${d.score}/${d.total}<br><strong>Notes:</strong> ${(d.notes||[]).join(' ')}</p>`;
        }
      }

      html+=`<hr><p><em>Send this PDF to: susan.centino@cirrusrecruitment.com</em></p></div>`;
      const win=window.open('', '_blank');
      win.document.write(`<html><head><title>${filename}</title><meta charset="utf-8"></head><body>${html}</body></html>`);
      win.document.close();
      setTimeout(()=>{win.print();},500);

      const post=document.getElementById('postExportMsg');
      post.classList.remove('hidden');
      post.innerHTML=`✅ <strong>Export complete.</strong> Please send your PDF to the examiner.`;
    }

    /* ===== Keyboard shortcut ===== */
    document.addEventListener('keydown',e=>{
      if(e.ctrlKey && e.altKey && (e.key==='E'||e.key==='e')) enableExaminerMode();
    });

    /* ===== Initialize ===== */
    document.addEventListener('DOMContentLoaded',()=>{
      document.getElementById('candidateName').addEventListener('blur',function(){
        const n=this.value.trim();
        if(n) updateOverallSummary(n);
      });

      // Hook up grader buttons
      document.getElementById('btnA1T1')?.addEventListener('click',gradeA1T1);
      document.getElementById('btnA1T2')?.addEventListener('click',gradeA1T2);
      document.getElementById('btnA2T1')?.addEventListener('click',gradeA2T1);
      document.getElementById('btnA2T2')?.addEventListener('click',gradeA2T2);
      document.getElementById('btnB1T1')?.addEventListener('click',gradeB1T1);
      document.getElementById('btnB1T2')?.addEventListener('click',gradeB1T2);
      document.getElementById('btnEssay')?.addEventListener('click',gradeEssay);
      document.getElementById('btnEmail')?.addEventListener('click',gradeEmail);
      document.getElementById('btnClearData')?.addEventListener('click',clearCandidateData);
      document.getElementById('btnExportPDF')?.addEventListener('click',confirmAndExport);
    });
  </script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skilled-Jobs English: Reading & Writing Tests</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#0f172a;}
    body{max-width:900px;margin:28px auto;padding:20px;background:#fff}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:1.25rem;margin:0}
    .name-field{font-size:0.95rem;border:1px solid #cbd5e1;border-radius:6px;padding:6px;width:260px}
    .level{border:1px solid #dbe7f7;border-radius:8px;padding:14px;margin:18px 0;background:#ffffff}
    h2{font-size:1.05rem;margin:6px 0}
    .passage{background:#fafafa;padding:10px;border-radius:6px;border:1px solid #eef2f7;margin-bottom:10px;font-size:0.95rem}
    .question{margin:8px 0;padding:8px;border-left:3px solid #e6eef8;background:transparent;border-radius:4px}
    label{display:block;cursor:pointer;margin:3px 0}
    .short-answer{width:100%;min-height:44px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{background:#0f172a;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    .result{margin-top:12px;padding:10px;border-radius:6px;background:#f8fafc;border:1px solid #e6eef8;font-size:0.95rem}
    textarea{width:100%;min-height:140px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .hint{font-size:0.9rem;color:#0f172a;background:#fbfbfb;padding:10px;border-radius:6px;border:1px solid #eef2f7}
    footer{margin-top:22px;font-size:0.9rem;color:#334155}
    .hidden{display:none}
    @media (max-width:700px){header{flex-direction:column;align-items:flex-start} .name-field{width:100%}}
  </style>
</head>
<body>
  <header>
    <h1>Skilled-Jobs English — Reading & Writing</h1>
    <div>
      <label for="candidateName"><strong>Candidate Name:</strong></label><br>
      <input id="candidateName" class="name-field" type="text" placeholder="Write your full name here">
    </div>
  </header>

  <p class="hint"><strong>Instructions:</strong> Complete all sections. After finishing, follow Final Instructions at the bottom to export your results and send them to the examiner.</p>

  <!-- ========== READING & WRITING TEST SECTIONS (SAME AS YOUR CODE) ========== -->
  <!-- (omitted here for brevity since your content was already correct) -->
  <!-- Keep all <section> ... </section> blocks exactly as you had them -->

  <!-- Final Instructions + Footer -->
  <div class="hint" id="finalInstructions">
    <strong>Final instructions (candidates):</strong>
    <ol>
      <li>Type your <strong>full name</strong> in the Candidate Name field at the top.</li>
      <li>When you have finished all sections, press <strong>Ctrl + Alt + E</strong> to unlock Examiner Tools.</li>
      <li>Click <strong>Export Results to PDF</strong>. Save the file as PDF when prompted.</li>
      <li>Send the saved PDF to: <strong>susan.centino@cirrusrecruitment.com</strong>.</li>
    </ol>
  </div>

  <footer>
    <p>Results are saved locally on your device. Examiner tools (clear/export) are hidden until unlocked.</p>
    <div id="adminControls" class="hidden">
      <button id="btnClearData">Clear Candidate Data</button>
      <button id="btnExportPDF">Export Results to PDF</button>
    </div>
    <div id="postExportMsg" class="result hidden" aria-live="polite"></div>
  </footer>

  <script>
    /* ===== Helper functions ===== */
    function normalize(s){return String(s||'').trim().toLowerCase();}
    function wordsCount(s){return s.trim().split(/\s+/).filter(Boolean).length;}

    function persist(name,key,value){
      if(!name) name='(No name)';
      const storeKey='skilledtest_'+name;
      let obj={};
      try{obj=JSON.parse(localStorage.getItem(storeKey))||{};}catch(e){}
      obj[key]=value;
      localStorage.setItem(storeKey,JSON.stringify(obj));
    }

    function loadStored(name){
      if(!name) name='(No name)';
      try{return JSON.parse(localStorage.getItem('skilledtest_'+name))||{};}catch(e){return {};}
    }

    function saveResult(domId,score,total,notes){
      const name=document.getElementById('candidateName').value.trim()||'(No name)';
      const el=document.getElementById(domId);
      el.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Score:</strong> ${score}/${total}<br><strong>Notes:</strong> ${notes.join(' ')}`;
      persist(name,domId,{score,total,notes,timestamp:new Date().toISOString()});
      updateOverallSummary(name);
    }

    function updateOverallSummary(name){
      const data=loadStored(name);
      let gained=0,possible=0;
      for(const k in data){
        if(data[k]&&typeof data[k].score==='number'){gained+=data[k].score;possible+=data[k].total;}
      }
      let summaryEl=document.getElementById('overallSummary');
      if(!summaryEl){
        summaryEl=document.createElement('div');
        summaryEl.id='overallSummary';
        summaryEl.className='result';
        document.body.appendChild(summaryEl);
      }
      if(possible>0){
        const pct=Math.round((gained/possible)*100);
        let level='Unassessed';
        if(pct>=85) level='B1+'; else if(pct>=70) level='B1'; else if(pct>=50) level='A2'; else level='A1 or below';
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Total:</strong> ${gained}/${possible} (${pct}%)<br><strong>Suggested level:</strong> ${level}`;
        persist(name,'overallSummary',{score:gained,total:possible,pct,level,timestamp:new Date().toISOString()});
      } else {
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><em>No submissions yet.</em>`;
      }
    }

    /* ===== Examiner mode ===== */
    function enableExaminerMode(){
      document.getElementById('adminControls').classList.remove('hidden');
      alert('Examiner mode enabled. Clear and Export buttons are now visible.');
    }

    function clearCandidateData(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Enter candidate name first.');return;}
      if(confirm(`Clear all saved data for "${name}"?`)){
        localStorage.removeItem('skilledtest_'+name);
        ['resA1T1','resA1T2','resA2T1','resA2T2','resB1T1','resB1T2','resEssay','resEmail','overallSummary'].forEach(id=>{
          const el=document.getElementById(id);
          if(el) el.innerHTML='';
        });
        alert('Data cleared for '+name);
      }
    }

    function confirmAndExport(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Please enter your name first.');return;}
      if(!confirm(`Export results for "${name}"?`)) return;

      const data=loadStored(name);
      const safeName=name.replace(/[^a-z0-9_\- ]/ig,'').replace(/\s+/g,'_');
      const filename=`SkilledJobs_EnglishResults_${safeName}.pdf`;

      let html=`<div style="font-family:system-ui,Segoe UI,Roboto,Arial;max-width:780px;margin:20px auto;color:#0f172a;">`;
      html+=`<h1>Skilled-Jobs English — Results</h1>`;
      html+=`<p><strong>Candidate:</strong> ${name}<br><strong>Generated:</strong> ${new Date().toLocaleString()}</p>`;

      for(const key in data){
        const d=data[key];
        if(d && d.score!==undefined){
          html+=`<hr><h3>${key}</h3><p><strong>Score:</strong> ${d.score}/${d.total}<br><strong>Notes:</strong> ${(d.notes||[]).join(' ')}</p>`;
        }
      }

      html+=`<hr><p><em>Send this PDF to: susan.centino@cirrusrecruitment.com</em></p></div>`;
      const win=window.open('', '_blank');
      win.document.write(`<html><head><title>${filename}</title><meta charset="utf-8"></head><body>${html}</body></html>`);
      win.document.close();
      setTimeout(()=>{win.print();},500);

      const post=document.getElementById('postExportMsg');
      post.classList.remove('hidden');
      post.innerHTML=`✅ <strong>Export complete.</strong> Please send your PDF to the examiner.`;
    }

    /* ===== Keyboard shortcut ===== */
    document.addEventListener('keydown',e=>{
      if(e.ctrlKey && e.altKey && (e.key==='E'||e.key==='e')) enableExaminerMode();
    });

    /* ===== Initialize ===== */
    document.addEventListener('DOMContentLoaded',()=>{
      document.getElementById('candidateName').addEventListener('blur',function(){
        const n=this.value.trim();
        if(n) updateOverallSummary(n);
      });

      // Hook up grader buttons
      document.getElementById('btnA1T1')?.addEventListener('click',gradeA1T1);
      document.getElementById('btnA1T2')?.addEventListener('click',gradeA1T2);
      document.getElementById('btnA2T1')?.addEventListener('click',gradeA2T1);
      document.getElementById('btnA2T2')?.addEventListener('click',gradeA2T2);
      document.getElementById('btnB1T1')?.addEventListener('click',gradeB1T1);
      document.getElementById('btnB1T2')?.addEventListener('click',gradeB1T2);
      document.getElementById('btnEssay')?.addEventListener('click',gradeEssay);
      document.getElementById('btnEmail')?.addEventListener('click',gradeEmail);
      document.getElementById('btnClearData')?.addEventListener('click',clearCandidateData);
      document.getElementById('btnExportPDF')?.addEventListener('click',confirmAndExport);
    });
  </script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skilled-Jobs English: Reading & Writing Tests</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#0f172a;}
    body{max-width:900px;margin:28px auto;padding:20px;background:#fff}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:1.25rem;margin:0}
    .name-field{font-size:0.95rem;border:1px solid #cbd5e1;border-radius:6px;padding:6px;width:260px}
    .level{border:1px solid #dbe7f7;border-radius:8px;padding:14px;margin:18px 0;background:#ffffff}
    h2{font-size:1.05rem;margin:6px 0}
    .passage{background:#fafafa;padding:10px;border-radius:6px;border:1px solid #eef2f7;margin-bottom:10px;font-size:0.95rem}
    .question{margin:8px 0;padding:8px;border-left:3px solid #e6eef8;background:transparent;border-radius:4px}
    label{display:block;cursor:pointer;margin:3px 0}
    .short-answer{width:100%;min-height:44px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{background:#0f172a;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    .result{margin-top:12px;padding:10px;border-radius:6px;background:#f8fafc;border:1px solid #e6eef8;font-size:0.95rem}
    textarea{width:100%;min-height:140px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .hint{font-size:0.9rem;color:#0f172a;background:#fbfbfb;padding:10px;border-radius:6px;border:1px solid #eef2f7}
    footer{margin-top:22px;font-size:0.9rem;color:#334155}
    .hidden{display:none}
    @media (max-width:700px){header{flex-direction:column;align-items:flex-start} .name-field{width:100%}}
  </style>
</head>
<body>
  <header>
    <h1>Skilled-Jobs English — Reading & Writing</h1>
    <div>
      <label for="candidateName"><strong>Candidate Name:</strong></label><br>
      <input id="candidateName" class="name-field" type="text" placeholder="Write your full name here">
    </div>
  </header>

  <p class="hint"><strong>Instructions:</strong> Complete all sections. After finishing, follow Final Instructions at the bottom to export your results and send them to the examiner.</p>

  <!-- ========== READING & WRITING TEST SECTIONS (SAME AS YOUR CODE) ========== -->
  <!-- (omitted here for brevity since your content was already correct) -->
  <!-- Keep all <section> ... </section> blocks exactly as you had them -->

  <!-- Final Instructions + Footer -->
  <div class="hint" id="finalInstructions">
    <strong>Final instructions (candidates):</strong>
    <ol>
      <li>Type your <strong>full name</strong> in the Candidate Name field at the top.</li>
      <li>When you have finished all sections, press <strong>Ctrl + Alt + E</strong> to unlock Examiner Tools.</li>
      <li>Click <strong>Export Results to PDF</strong>. Save the file as PDF when prompted.</li>
      <li>Send the saved PDF to: <strong>susan.centino@cirrusrecruitment.com</strong>.</li>
    </ol>
  </div>

  <footer>
    <p>Results are saved locally on your device. Examiner tools (clear/export) are hidden until unlocked.</p>
    <div id="adminControls" class="hidden">
      <button id="btnClearData">Clear Candidate Data</button>
      <button id="btnExportPDF">Export Results to PDF</button>
    </div>
    <div id="postExportMsg" class="result hidden" aria-live="polite"></div>
  </footer>

  <script>
    /* ===== Helper functions ===== */
    function normalize(s){return String(s||'').trim().toLowerCase();}
    function wordsCount(s){return s.trim().split(/\s+/).filter(Boolean).length;}

    function persist(name,key,value){
      if(!name) name='(No name)';
      const storeKey='skilledtest_'+name;
      let obj={};
      try{obj=JSON.parse(localStorage.getItem(storeKey))||{};}catch(e){}
      obj[key]=value;
      localStorage.setItem(storeKey,JSON.stringify(obj));
    }

    function loadStored(name){
      if(!name) name='(No name)';
      try{return JSON.parse(localStorage.getItem('skilledtest_'+name))||{};}catch(e){return {};}
    }

    function saveResult(domId,score,total,notes){
      const name=document.getElementById('candidateName').value.trim()||'(No name)';
      const el=document.getElementById(domId);
      el.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Score:</strong> ${score}/${total}<br><strong>Notes:</strong> ${notes.join(' ')}`;
      persist(name,domId,{score,total,notes,timestamp:new Date().toISOString()});
      updateOverallSummary(name);
    }

    function updateOverallSummary(name){
      const data=loadStored(name);
      let gained=0,possible=0;
      for(const k in data){
        if(data[k]&&typeof data[k].score==='number'){gained+=data[k].score;possible+=data[k].total;}
      }
      let summaryEl=document.getElementById('overallSummary');
      if(!summaryEl){
        summaryEl=document.createElement('div');
        summaryEl.id='overallSummary';
        summaryEl.className='result';
        document.body.appendChild(summaryEl);
      }
      if(possible>0){
        const pct=Math.round((gained/possible)*100);
        let level='Unassessed';
        if(pct>=85) level='B1+'; else if(pct>=70) level='B1'; else if(pct>=50) level='A2'; else level='A1 or below';
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Total:</strong> ${gained}/${possible} (${pct}%)<br><strong>Suggested level:</strong> ${level}`;
        persist(name,'overallSummary',{score:gained,total:possible,pct,level,timestamp:new Date().toISOString()});
      } else {
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><em>No submissions yet.</em>`;
      }
    }

    /* ===== Examiner mode ===== */
    function enableExaminerMode(){
      document.getElementById('adminControls').classList.remove('hidden');
      alert('Examiner mode enabled. Clear and Export buttons are now visible.');
    }

    function clearCandidateData(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Enter candidate name first.');return;}
      if(confirm(`Clear all saved data for "${name}"?`)){
        localStorage.removeItem('skilledtest_'+name);
        ['resA1T1','resA1T2','resA2T1','resA2T2','resB1T1','resB1T2','resEssay','resEmail','overallSummary'].forEach(id=>{
          const el=document.getElementById(id);
          if(el) el.innerHTML='';
        });
        alert('Data cleared for '+name);
      }
    }

    function confirmAndExport(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Please enter your name first.');return;}
      if(!confirm(`Export results for "${name}"?`)) return;

      const data=loadStored(name);
      const safeName=name.replace(/[^a-z0-9_\- ]/ig,'').replace(/\s+/g,'_');
      const filename=`SkilledJobs_EnglishResults_${safeName}.pdf`;

      let html=`<div style="font-family:system-ui,Segoe UI,Roboto,Arial;max-width:780px;margin:20px auto;color:#0f172a;">`;
      html+=`<h1>Skilled-Jobs English — Results</h1>`;
      html+=`<p><strong>Candidate:</strong> ${name}<br><strong>Generated:</strong> ${new Date().toLocaleString()}</p>`;

      for(const key in data){
        const d=data[key];
        if(d && d.score!==undefined){
          html+=`<hr><h3>${key}</h3><p><strong>Score:</strong> ${d.score}/${d.total}<br><strong>Notes:</strong> ${(d.notes||[]).join(' ')}</p>`;
        }
      }

      html+=`<hr><p><em>Send this PDF to: susan.centino@cirrusrecruitment.com</em></p></div>`;
      const win=window.open('', '_blank');
      win.document.write(`<html><head><title>${filename}</title><meta charset="utf-8"></head><body>${html}</body></html>`);
      win.document.close();
      setTimeout(()=>{win.print();},500);

      const post=document.getElementById('postExportMsg');
      post.classList.remove('hidden');
      post.innerHTML=`✅ <strong>Export complete.</strong> Please send your PDF to the examiner.`;
    }

    /* ===== Keyboard shortcut ===== */
    document.addEventListener('keydown',e=>{
      if(e.ctrlKey && e.altKey && (e.key==='E'||e.key==='e')) enableExaminerMode();
    });

    /* ===== Initialize ===== */
    document.addEventListener('DOMContentLoaded',()=>{
      document.getElementById('candidateName').addEventListener('blur',function(){
        const n=this.value.trim();
        if(n) updateOverallSummary(n);
      });

      // Hook up grader buttons
      document.getElementById('btnA1T1')?.addEventListener('click',gradeA1T1);
      document.getElementById('btnA1T2')?.addEventListener('click',gradeA1T2);
      document.getElementById('btnA2T1')?.addEventListener('click',gradeA2T1);
      document.getElementById('btnA2T2')?.addEventListener('click',gradeA2T2);
      document.getElementById('btnB1T1')?.addEventListener('click',gradeB1T1);
      document.getElementById('btnB1T2')?.addEventListener('click',gradeB1T2);
      document.getElementById('btnEssay')?.addEventListener('click',gradeEssay);
      document.getElementById('btnEmail')?.addEventListener('click',gradeEmail);
      document.getElementById('btnClearData')?.addEventListener('click',clearCandidateData);
      document.getElementById('btnExportPDF')?.addEventListener('click',confirmAndExport);
    });
  </script>
</body>
</html>
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Skilled-Jobs English: Reading & Writing Tests</title>
  <style>
    :root{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial; color:#0f172a;}
    body{max-width:900px;margin:28px auto;padding:20px;background:#fff}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    h1{font-size:1.25rem;margin:0}
    .name-field{font-size:0.95rem;border:1px solid #cbd5e1;border-radius:6px;padding:6px;width:260px}
    .level{border:1px solid #dbe7f7;border-radius:8px;padding:14px;margin:18px 0;background:#ffffff}
    h2{font-size:1.05rem;margin:6px 0}
    .passage{background:#fafafa;padding:10px;border-radius:6px;border:1px solid #eef2f7;margin-bottom:10px;font-size:0.95rem}
    .question{margin:8px 0;padding:8px;border-left:3px solid #e6eef8;background:transparent;border-radius:4px}
    label{display:block;cursor:pointer;margin:3px 0}
    .short-answer{width:100%;min-height:44px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;margin-top:12px}
    button{background:#0f172a;color:#fff;border:none;padding:8px 12px;border-radius:6px;cursor:pointer}
    .result{margin-top:12px;padding:10px;border-radius:6px;background:#f8fafc;border:1px solid #e6eef8;font-size:0.95rem}
    textarea{width:100%;min-height:140px;padding:8px;border:1px solid #e6eef8;border-radius:6px;font-size:0.95rem}
    .hint{font-size:0.9rem;color:#0f172a;background:#fbfbfb;padding:10px;border-radius:6px;border:1px solid #eef2f7}
    footer{margin-top:22px;font-size:0.9rem;color:#334155}
    .hidden{display:none}
    @media (max-width:700px){header{flex-direction:column;align-items:flex-start} .name-field{width:100%}}
  </style>
</head>
<body>
  <header>
    <h1>Skilled-Jobs English — Reading & Writing</h1>
    <div>
      <label for="candidateName"><strong>Candidate Name:</strong></label><br>
      <input id="candidateName" class="name-field" type="text" placeholder="Write your full name here">
    </div>
  </header>

  <p class="hint"><strong>Instructions:</strong> Complete all sections. After finishing, follow Final Instructions at the bottom to export your results and send them to the examiner.</p>

  <!-- ========== READING & WRITING TEST SECTIONS (SAME AS YOUR CODE) ========== -->
  <!-- (omitted here for brevity since your content was already correct) -->
  <!-- Keep all <section> ... </section> blocks exactly as you had them -->

  <!-- Final Instructions + Footer -->
  <div class="hint" id="finalInstructions">
    <strong>Final instructions (candidates):</strong>
    <ol>
      <li>Type your <strong>full name</strong> in the Candidate Name field at the top.</li>
      <li>When you have finished all sections, press <strong>Ctrl + Alt + E</strong> to unlock Examiner Tools.</li>
      <li>Click <strong>Export Results to PDF</strong>. Save the file as PDF when prompted.</li>
      <li>Send the saved PDF to: <strong>susan.centino@cirrusrecruitment.com</strong>.</li>
    </ol>
  </div>

  <footer>
    <p>Results are saved locally on your device. Examiner tools (clear/export) are hidden until unlocked.</p>
    <div id="adminControls" class="hidden">
      <button id="btnClearData">Clear Candidate Data</button>
      <button id="btnExportPDF">Export Results to PDF</button>
    </div>
    <div id="postExportMsg" class="result hidden" aria-live="polite"></div>
  </footer>

  <script>
    /* ===== Helper functions ===== */
    function normalize(s){return String(s||'').trim().toLowerCase();}
    function wordsCount(s){return s.trim().split(/\s+/).filter(Boolean).length;}

    function persist(name,key,value){
      if(!name) name='(No name)';
      const storeKey='skilledtest_'+name;
      let obj={};
      try{obj=JSON.parse(localStorage.getItem(storeKey))||{};}catch(e){}
      obj[key]=value;
      localStorage.setItem(storeKey,JSON.stringify(obj));
    }

    function loadStored(name){
      if(!name) name='(No name)';
      try{return JSON.parse(localStorage.getItem('skilledtest_'+name))||{};}catch(e){return {};}
    }

    function saveResult(domId,score,total,notes){
      const name=document.getElementById('candidateName').value.trim()||'(No name)';
      const el=document.getElementById(domId);
      el.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Score:</strong> ${score}/${total}<br><strong>Notes:</strong> ${notes.join(' ')}`;
      persist(name,domId,{score,total,notes,timestamp:new Date().toISOString()});
      updateOverallSummary(name);
    }

    function updateOverallSummary(name){
      const data=loadStored(name);
      let gained=0,possible=0;
      for(const k in data){
        if(data[k]&&typeof data[k].score==='number'){gained+=data[k].score;possible+=data[k].total;}
      }
      let summaryEl=document.getElementById('overallSummary');
      if(!summaryEl){
        summaryEl=document.createElement('div');
        summaryEl.id='overallSummary';
        summaryEl.className='result';
        document.body.appendChild(summaryEl);
      }
      if(possible>0){
        const pct=Math.round((gained/possible)*100);
        let level='Unassessed';
        if(pct>=85) level='B1+'; else if(pct>=70) level='B1'; else if(pct>=50) level='A2'; else level='A1 or below';
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><strong>Total:</strong> ${gained}/${possible} (${pct}%)<br><strong>Suggested level:</strong> ${level}`;
        persist(name,'overallSummary',{score:gained,total:possible,pct,level,timestamp:new Date().toISOString()});
      } else {
        summaryEl.innerHTML=`<strong>Candidate:</strong> ${name}<br><em>No submissions yet.</em>`;
      }
    }

    /* ===== Examiner mode ===== */
    function enableExaminerMode(){
      document.getElementById('adminControls').classList.remove('hidden');
      alert('Examiner mode enabled. Clear and Export buttons are now visible.');
    }

    function clearCandidateData(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Enter candidate name first.');return;}
      if(confirm(`Clear all saved data for "${name}"?`)){
        localStorage.removeItem('skilledtest_'+name);
        ['resA1T1','resA1T2','resA2T1','resA2T2','resB1T1','resB1T2','resEssay','resEmail','overallSummary'].forEach(id=>{
          const el=document.getElementById(id);
          if(el) el.innerHTML='';
        });
        alert('Data cleared for '+name);
      }
    }

    function confirmAndExport(){
      const name=document.getElementById('candidateName').value.trim();
      if(!name){alert('Please enter your name first.');return;}
      if(!confirm(`Export results for "${name}"?`)) return;

      const data=loadStored(name);
      const safeName=name.replace(/[^a-z0-9_\- ]/ig,'').replace(/\s+/g,'_');
      const filename=`SkilledJobs_EnglishResults_${safeName}.pdf`;

      let html=`<div style="font-family:system-ui,Segoe UI,Roboto,Arial;max-width:780px;margin:20px auto;color:#0f172a;">`;
      html+=`<h1>Skilled-Jobs English — Results</h1>`;
      html+=`<p><strong>Candidate:</strong> ${name}<br><strong>Generated:</strong> ${new Date().toLocaleString()}</p>`;

      for(const key in data){
        const d=data[key];
        if(d && d.score!==undefined){
          html+=`<hr><h3>${key}</h3><p><strong>Score:</strong> ${d.score}/${d.total}<br><strong>Notes:</strong> ${(d.notes||[]).join(' ')}</p>`;
        }
      }

      html+=`<hr><p><em>Send this PDF to: susan.centino@cirrusrecruitment.com</em></p></div>`;
      const win=window.open('', '_blank');
      win.document.write(`<html><head><title>${filename}</title><meta charset="utf-8"></head><body>${html}</body></html>`);
      win.document.close();
      setTimeout(()=>{win.print();},500);

      const post=document.getElementById('postExportMsg');
      post.classList.remove('hidden');
      post.innerHTML=`✅ <strong>Export complete.</strong> Please send your PDF to the examiner.`;
    }

    /* ===== Keyboard shortcut ===== */
    document.addEventListener('keydown',e=>{
      if(e.ctrlKey && e.altKey && (e.key==='E'||e.key==='e')) enableExaminerMode();
    });

    /* ===== Initialize ===== */
    document.addEventListener('DOMContentLoaded',()=>{
      document.getElementById('candidateName').addEventListener('blur',function(){
        const n=this.value.trim();
        if(n) updateOverallSummary(n);
      });

      // Hook up grader buttons
      document.getElementById('btnA1T1')?.addEventListener('click',gradeA1T1);
      document.getElementById('btnA1T2')?.addEventListener('click',gradeA1T2);
      document.getElementById('btnA2T1')?.addEventListener('click',gradeA2T1);
      document.getElementById('btnA2T2')?.addEventListener('click',gradeA2T2);
      document.getElementById('btnB1T1')?.addEventListener('click',gradeB1T1);
      document.getElementById('btnB1T2')?.addEventListener('click',gradeB1T2);
      document.getElementById('btnEssay')?.addEventListener('click',gradeEssay);
      document.getElementById('btnEmail')?.addEventListener('click',gradeEmail);
      document.getElementById('btnClearData')?.addEventListener('click',clearCandidateData);
      document.getElementById('btnExportPDF')?.addEventListener('click',confirmAndExport);
    });
  </script>
</body>
</html>
